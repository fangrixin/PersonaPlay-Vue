
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MBTIæ€§æ ¼æµ‹è¯•</title>
  <style>
    :root {
      --primary-color: #6a5acd;
      --secondary-color: #9370db;
      --accent-color: #ff7f50;
      --light-bg: #f8f9fa;
      --dark-bg: #343a40;
      --text-color: #333;
      --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-2: linear-gradient(135deg, #5ee7df 0%, #b490ca 100%);
      --gradient-3: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      --card-shadow: 0 10px 20px rgba(0,0,0,0.1);
      --card-hover-shadow: 0 15px 30px rgba(0,0,0,0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
    }

    body {
      background: var(--gradient-1);
      color: var(--text-color);
      min-height: 100vh;
      position: relative;
    }

    body::before {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 70%);
      z-index: -1;
    }

    body::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 60%);
      z-index: -1;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      position: relative;
      z-index: 1;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
      animation: fadeIn 1s ease;
      position: relative;
    }

    header::after {
      content: "";
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background: var(--accent-color);
      border-radius: 3px;
    }

    h1 {
      font-size: 2.5rem;
      color: white;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }

    .subtitle {
      font-size: 1.2rem;
      color: rgba(255,255,255,0.8);
      margin-bottom: 20px;
    }

    .card {
      background: white;
      border-radius: 15px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: var(--card-shadow);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      top: -10px;
      right: -10px;
      width: 120px;
      height: 120px;
      background: var(--gradient-2);
      opacity: 0.05;
      border-radius: 50%;
      z-index: 0;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: var(--card-hover-shadow);
    }

    .test-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
      position: relative;
      z-index: 1;
    }

    .option-card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .option-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: var(--gradient-3);
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.3s ease;
    }

    .option-card:hover::before {
      transform: scaleX(1);
    }

    .option-card:hover {
      background: var(--primary-color);
      color: white;
      transform: scale(1.03);
    }

    .option-card h3 {
      font-size: 1.3rem;
      margin-bottom: 10px;
    }

    .option-card p {
      font-size: 0.9rem;
      color: #666;
    }

    .option-card:hover p {
      color: rgba(255,255,255,0.8);
    }

    .icon {
      font-size: 2.5rem;
      margin-bottom: 15px;
      color: var(--accent-color);
      position: relative;
      z-index: 1;
    }

    .icon::after {
      content: "";
      position: absolute;
      width: 50px;
      height: 50px;
      background: rgba(255,127,80,0.1);
      border-radius: 50%;
      z-index: -1;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .option-card:hover .icon {
      color: white;
    }

    .option-card:hover .icon::after {
      background: rgba(255,255,255,0.2);
    }

    .btn {
      background: var(--primary-color);
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      margin: 10px 5px;
      position: relative;
      overflow: hidden;
    }

    .btn::after {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: 0.5s;
    }

    .btn:hover::after {
      left: 100%;
    }

    .btn:hover {
      background: var(--secondary-color);
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }

    .btn-outline {
      background: transparent;
      border: 2px solid var(--primary-color);
      color: var(--primary-color);
    }

    .btn-outline:hover {
      background: var(--primary-color);
      color: white;
    }

    .btn-wechat {
      background: #07C160;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .btn-wechat:hover {
      background: #06AD56;
    }

    .room-info {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }

    .room-id {
      background: var(--light-bg);
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 1.2rem;
      border: 2px dashed var(--secondary-color);
    }

    .question-container {
      margin-top: 20px;
      animation: slideUp 0.5s ease;
      position: relative;
      z-index: 1;
    }

    .question {
      font-size: 1.3rem;
      margin-bottom: 20px;
      color: var(--dark-bg);
      line-height: 1.6;
    }

    .answers {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .answer-option {
      padding: 15px 20px;
      background: white;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      border-left: 3px solid transparent;
    }

    .answer-option:hover {
      background: var(--secondary-color);
      color: white;
      transform: translateX(5px);
      border-left: 3px solid var(--accent-color);
    }

    .players-status {
      display: flex;
      justify-content: space-around;
      margin: 20px 0;
    }

    .player {
      text-align: center;
      padding: 15px;
      border-radius: 10px;
      background: white;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      min-width: 120px;
      position: relative;
      overflow: hidden;
    }

    .player::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: var(--gradient-3);
    }

    .player-name {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .player-status {
      color: var(--accent-color);
    }

    .timer {
      font-size: 2rem;
      text-align: center;
      margin: 20px 0;
      color: var(--accent-color);
      text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
    }

    .progress-bar {
      height: 10px;
      background: #eee;
      border-radius: 5px;
      margin: 20px 0;
      overflow: hidden;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }

    .progress {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      border-radius: 5px;
      width: 0%;
      transition: width 0.3s ease;
      position: relative;
    }

    .progress::after {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      width: 20px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3));
    }

    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      animation: fadeIn 0.3s ease;
      backdrop-filter: blur(5px);
    }

    .modal-content {
      background: white;
      border-radius: 15px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
      animation: scaleIn 0.3s ease;
      box-shadow: 0 15px 30px rgba(0,0,0,0.2);
      position: relative;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      position: relative;
    }

    .modal-header::after {
      content: "";
      position: absolute;
      bottom: -10px;
      left: 0;
      width: 100%;
      height: 1px;
      background: #eee;
    }

    .modal-title {
      font-size: 1.5rem;
      color: var(--primary-color);
      font-weight: bold;
    }

    .close-btn {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #999;
      transition: color 0.3s ease;
    }

    .close-btn:hover {
      color: var(--accent-color);
    }

    .mbti-selector {
      display: flex;
      justify-content: space-between;
      margin: 20px 0;
      padding: 20px;
      background: var(--light-bg);
      border-radius: 10px;
      box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
    }

    .letter-selector {
      text-align: center;
      position: relative;
      width: 23%;
    }

    .letter-display {
      font-size: 2rem;
      font-weight: bold;
      padding: 10px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 10px;
      color: var(--primary-color);
      position: relative;
      overflow: hidden;
    }

    .letter-display::after {
      content: "";
      position: absolute;
      width: 100%;
      height: 5px;
      bottom: 0;
      left: 0;
      background: var(--gradient-3);
      opacity: 0.3;
    }

    .letter-hint {
      background: var(--primary-color);
      color: white;
      padding: 8px;
      border-radius: 5px;
      font-size: 0.8rem;
      margin-top: 10px;
      min-height: 60px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .selector-arrows {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .arrow {
      cursor: pointer;
      font-size: 1.2rem;
      padding: 5px;
      color: var(--secondary-color);
      transition: transform 0.2s ease, color 0.2s ease;
    }

    .arrow:hover {
      transform: scale(1.2);
      color: var(--accent-color);
    }

    .result-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      position: relative;
      overflow: hidden;
    }

    .result-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: var(--gradient-2);
    }

    .result-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
    }

    .result-type {
      font-size: 2rem;
      font-weight: bold;
      color: var(--primary-color);
      position: relative;
    }

    .result-type::after {
      content: "";
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 100%;
      height: 2px;
      background: var(--accent-color);
      opacity: 0.5;
    }

    .result-name {
      font-size: 1.2rem;
      color: var(--secondary-color);
    }

    .result-description {
      margin-bottom: 15px;
      line-height: 1.6;
      color: #444;
    }

    .compatibility {
      background: var(--light-bg);
      padding: 15px;
      border-radius: 8px;
      margin-top: 20px;
      position: relative;
      box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
    }

    .compatibility::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: var(--gradient-2);
      border-radius: 8px 0 0 8px;
    }

    .compatibility-title {
      font-weight: bold;
      margin-bottom: 10px;
      color: var(--primary-color);
    }

    .qrcode {
      width: 150px;
      height: 150px;
      background: white;
      border-radius: 10px;
      padding: 10px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      position: relative;
    }

    .qrcode::before {
      content: "";
      position: absolute;
      inset: 6px;
      border: 2px dashed rgba(0,0,0,0.1);
      border-radius: 6px;
      z-index: 0;
    }

    .qrcode img {
      max-width: 100%;
      position: relative;
      z-index: 1;
    }

    .share-options {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 15px;
    }

    /* åº•éƒ¨å¯¼èˆª */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: white;
      display: flex;
      justify-content: space-around;
      padding: 10px 0;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
      z-index: 100;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 0.9rem;
      color: #666;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .nav-item.active {
      color: var(--primary-color);
    }

    .nav-icon {
      font-size: 1.5rem;
      margin-bottom: 5px;
    }

    /* æˆ‘çš„é¡µé¢ */
    .profile-header {
      display: flex;
      align-items: center;
      margin-bottom: 30px;
    }

    .profile-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      overflow: hidden;
      margin-right: 20px;
      border: 3px solid white;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .profile-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .profile-info {
      flex: 1;
    }

    .profile-name {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 5px;
      color: white;
    }

    .profile-mbti {
      font-size: 1rem;
      color: rgba(255,255,255,0.8);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .profile-mbti-type {
      background: rgba(255,255,255,0.2);
      padding: 3px 10px;
      border-radius: 20px;
      font-weight: bold;
    }

    .history-item {
      background: white;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      gap: 15px;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .history-item::before {
      content: "";
      position: absolute;
      left: 0;
      top: 0;
      width: 5px;
      height: 100%;
      background: var(--gradient-2);
    }

    .history-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.15);
    }

    .history-date {
      background: var(--light-bg);
      border-radius: 5px;
      padding: 8px;
      text-align: center;
      min-width: 60px;
      font-size: 0.9rem;
      color: var(--secondary-color);
    }

    .history-date-day {
      font-size: 1.3rem;
      font-weight: bold;
      margin-bottom: 3px;
      color: var(--primary-color);
    }

    .history-content {
      flex: 1;
    }

    .history-title {
      font-weight: bold;
      margin-bottom: 5px;
      color: var(--dark-bg);
    }

    .history-type {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .history-mbti {
      background: var(--light-bg);
      padding: 3px 10px;
      border-radius: 15px;
      font-size: 0.9rem;
      color: var(--primary-color);
      font-weight: bold;
    }

    .history-with {
      font-size: 0.9rem;
      color: #666;
    }

    .history-arrow {
      color: #999;
      font-size: 1.2rem;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideUp {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    @keyframes scaleIn {
      from { transform: scale(0.9); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    /* é€‚é…ä¸åŒè®¾å¤‡ */
    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }

      h1 {
        font-size: 2rem;
      }

      .card {
        padding: 20px;
      }

      .option-card {
        padding: 15px;
      }

      .modal-content {
        padding: 20px;
        width: 95%;
      }
    }
  </style>
</head>
<body>
<!-- åº•éƒ¨å¯¼èˆªæ  -->
<div class="bottom-nav">
  <div class="nav-item active" onclick="showHomePage()">
    <div class="nav-icon">ğŸ </div>
    <div>é¦–é¡µ</div>
  </div>
  <div class="nav-item" onclick="showTestHistory()">
    <div class="nav-icon">ğŸ“Š</div>
    <div>æˆ‘çš„</div>
  </div>
</div>

<!-- é¦–é¡µ -->
<div class="container" id="home-page">
  <header>
    <h1>MBTI æ€§æ ¼æµ‹è¯•</h1>
    <p class="subtitle">æ¢ç´¢ä½ çš„æ€§æ ¼ï¼Œäº†è§£ä½ çš„å†…å¿ƒä¸–ç•Œ</p>
  </header>

  <div class="card">
    <h2>é€‰æ‹©æµ‹è¯•æ¨¡å¼</h2>
    <div class="test-options">
      <div class="option-card" onclick="showSingleTestOptions()">
        <div class="icon">ğŸ‘¤</div>
        <h3>å•äººæµ‹è¯•</h3>
        <p>æ·±å…¥äº†è§£è‡ªå·±çš„æ€§æ ¼ç±»å‹å’Œç‰¹ç‚¹</p>
      </div>
      <div class="option-card" onclick="showDualTestOptions()">
        <div class="icon">ğŸ‘¥</div>
        <h3>åŒäººæµ‹è¯•</h3>
        <p>ä¸æœ‹å‹ä¸€èµ·æµ‹è¯•ï¼Œæ¯”è¾ƒå½¼æ­¤çš„æ€§æ ¼å·®å¼‚</p>
      </div>
    </div>
  </div>
</div>

<!-- å•äººæµ‹è¯•é€‰é¡¹é¡µ -->
<div class="container" id="single-test-options-page" style="display: none;">
  <header>
    <h1>å•äººæµ‹è¯•</h1>
    <p class="subtitle">é€‰æ‹©æµ‹è¯•ç‰ˆæœ¬å¼€å§‹æ¢ç´¢</p>
  </header>

  <div class="card">
    <h2>é€‰æ‹©æµ‹è¯•ç‰ˆæœ¬</h2>
    <div class="test-options">
      <div class="option-card" onclick="startSingleTest('short')">
        <div class="icon">âš¡</div>
        <h3>ç®€çŸ­ç‰ˆ (20é¢˜)</h3>
        <p>å¿«é€Ÿäº†è§£åŸºæœ¬æ€§æ ¼ç‰¹ç‚¹</p>
      </div>
      <div class="option-card" onclick="startSingleTest('standard')">
        <div class="icon">â­</div>
        <h3>æ ‡å‡†ç‰ˆ (60é¢˜)</h3>
        <p>å…¨é¢äº†è§£æ€§æ ¼å„ä¸ªç»´åº¦</p>
      </div>
      <div class="option-card" onclick="startSingleTest('full')">
        <div class="icon">ğŸ”</div>
        <h3>å®Œæ•´ç‰ˆ (93é¢˜)</h3>
        <p>æ·±å…¥æ¢ç´¢æ€§æ ¼çš„ç»†å¾®å·®åˆ«</p>
      </div>
    </div>
    <div style="text-align: center; margin-top: 20px;">
      <button class="btn btn-outline" onclick="showHomePage()">è¿”å›</button>
    </div>
  </div>
</div>

<!-- åŒäººæµ‹è¯•é€‰é¡¹é¡µ -->
<div class="container" id="dual-test-options-page" style="display: none;">
  <header>
    <h1>åŒäººæµ‹è¯•</h1>
    <p class="subtitle">ä¸æœ‹å‹ä¸€èµ·æ¢ç´¢æ€§æ ¼</p>
  </header>

  <div class="card">
    <h2>é€‰æ‹©æ“ä½œ</h2>
    <div class="test-options">
      <div class="option-card" onclick="createRoom()">
        <div class="icon">ğŸ </div>
        <h3>åˆ›å»ºæˆ¿é—´</h3>
        <p>åˆ›å»ºä¸€ä¸ªæ–°çš„æµ‹è¯•æˆ¿é—´å¹¶é‚€è¯·æœ‹å‹</p>
      </div>
      <div class="option-card" onclick="showJoinRoomPage()">
        <div class="icon">ğŸšª</div>
        <h3>åŠ å…¥æˆ¿é—´</h3>
        <p>é€šè¿‡æˆ¿é—´å·åŠ å…¥æœ‹å‹çš„æµ‹è¯•</p>
      </div>
    </div>
    <div style="text-align: center; margin-top: 20px;">
      <button class="btn btn-outline" onclick="showHomePage()">è¿”å›</button>
    </div>
  </div>
</div>

<!-- åˆ›å»ºæˆ¿é—´é¡µé¢ -->
<div class="container" id="create-room-page" style="display: none;">
  <header>
    <h1>åˆ›å»ºæµ‹è¯•æˆ¿é—´</h1>
    <p class="subtitle">é‚€è¯·æœ‹å‹ä¸€èµ·æµ‹è¯•</p>
  </header>

  <div class="card">
    <h2>æµ‹è¯•è®¾ç½®</h2>
    <div style="margin: 20px 0;">
      <p style="margin-bottom: 20px; color: var(--primary-color); font-weight: bold;">ä½ å·²é€šè¿‡å¾®ä¿¡æˆæƒç™»å½•ï¼Œæ˜µç§°: <span id="wx-nickname">å¾®ä¿¡ç”¨æˆ·</span></p>

      <label style="display: block; margin-bottom: 10px;">é€‰æ‹©æµ‹è¯•ç‰ˆæœ¬:</label>
      <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
        <button class="btn btn-outline" onclick="selectTestVersion('short')">ç®€çŸ­ç‰ˆ (20é¢˜)</button>
        <button class="btn btn-outline" onclick="selectTestVersion('standard')">æ ‡å‡†ç‰ˆ (60é¢˜)</button>
        <button class="btn btn-outline" onclick="selectTestVersion('full')">å®Œæ•´ç‰ˆ (93é¢˜)</button>
      </div>
    </div>

    <div style="text-align: center;">
      <button class="btn" onclick="generateRoom()">åˆ›å»ºæˆ¿é—´</button>
      <button class="btn btn-outline" onclick="showDualTestOptions()">è¿”å›</button>
    </div>
  </div>
</div>

<!-- æˆ¿é—´ä¿¡æ¯é¡µé¢ -->
<div class="container" id="room-info-page" style="display: none;">
  <header>
    <h1>æˆ¿é—´å·²åˆ›å»º</h1>
    <p class="subtitle">é‚€è¯·æœ‹å‹åŠ å…¥ä½ çš„æµ‹è¯•</p>
  </header>

  <div class="card">
    <h2>æˆ¿é—´ä¿¡æ¯</h2>
    <div class="room-info">
      <div class="room-id">æˆ¿é—´å·: <span id="room-id">123456</span></div>
      <button class="btn" onclick="copyRoomId()">å¤åˆ¶</button>
    </div>

    <div style="text-align: center; margin: 30px 0;">
      <p style="margin-bottom: 15px;">æ‰«æäºŒç»´ç åŠ å…¥</p>
      <div class="qrcode">
        <img src="https://via.placeholder.com/150" alt="QR Code">
      </div>

      <div class="share-options">
        <button class="btn" onclick="shareLink()">åˆ†äº«é“¾æ¥</button>
        <button class="btn" onclick="downloadQRCode()">ä¿å­˜äºŒç»´ç </button>
      </div>
    </div>

    <div class="players-status">
      <div class="player">
        <div class="player-name" id="player1-name">ç©å®¶1</div>
        <div class="player-status">å·²å‡†å¤‡</div>
      </div>
      <div class="player">
        <div class="player-name" id="player2-name">ç­‰å¾…åŠ å…¥...</div>
        <div class="player-status">æœªå‡†å¤‡</div>
      </div>
    </div>

    <div style="text-align: center; margin-top: 30px;">
      <button id="start-test-btn" class="btn" disabled>å¼€å§‹æµ‹è¯•</button>
      <button class="btn btn-outline" onclick="exitRoom()">é€€å‡ºæˆ¿é—´</button>
    </div>
  </div>
</div>

<!-- åŠ å…¥æˆ¿é—´é¡µé¢ -->
<div class="container" id="join-room-page" style="display: none;">
  <header>
    <h1>åŠ å…¥æµ‹è¯•æˆ¿é—´</h1>
    <p class="subtitle">è¾“å…¥æˆ¿é—´å·åŠ å…¥å¥½å‹çš„æµ‹è¯•</p>
  </header>

  <div class="card">
    <h2>è¾“å…¥æˆ¿é—´ä¿¡æ¯</h2>
    <div style="margin: 20px 0;">
      <label for="room-code" style="display: block; margin-bottom: 10px;">æˆ¿é—´å·:</label>
      <input type="text" id="room-code" placeholder="è¾“å…¥6ä½æˆ¿é—´å·" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #ddd; margin-bottom: 20px;">

      <button class="btn btn-wechat" style="width: 100%; margin-bottom: 20px;">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
          <path d="M8.69,11.71a1.23,1.23,0,1,1,1.24-1.23A1.24,1.24,0,0,1,8.69,11.71Zm3.92-2.45a1.23,1.23,0,1,0,1.23,1.22A1.24,1.24,0,0,0,12.61,9.26ZM19.62,12a7.7,7.7,0,0,0-8.35-7.66,7.7,7.7,0,0,0-8.35,7.66,7.7,7.7,0,0,0,3.84,6.62l-.78,2.36a.32.32,0,0,0,.47.39l2.75-1.41A8.51,8.51,0,0,0,11.27,20,7.7,7.7,0,0,0,19.62,12Z"/>
        </svg>
        å¾®ä¿¡æˆæƒç™»å½•
      </button>
    </div>

    <div style="text-align: center;">
      <button class="btn" onclick="joinRoom()">åŠ å…¥æˆ¿é—´</button>
      <button class="btn btn-outline" onclick="showDualTestOptions()">è¿”å›</button>
    </div>
  </div>
</div>

<!-- æµ‹è¯•é—®é¢˜é¡µé¢ -->
<div class="container" id="test-page" style="display: none;">
  <header>
    <h1>MBTI æ€§æ ¼æµ‹è¯•</h1>
    <p class="subtitle" id="test-version-title">æ ‡å‡†ç‰ˆæµ‹è¯• (60é¢˜)</p>
  </header>

  <div class="card">
    <div class="progress-bar">
      <div class="progress" id="test-progress" style="width: 30%;"></div>
    </div>

    <div id="dual-test-info" style="display: none;">
      <div class="players-status">
        <div class="player">
          <div class="player-name">ç©å®¶1</div>
          <div class="player-status">å·²å›ç­”</div>
        </div>
        <div class="player">
          <div class="player-name">ç©å®¶2</div>
          <div class="player-status">æ€è€ƒä¸­...</div>
        </div>
      </div>
      <div class="timer">25</div>
    </div>

    <div class="question-container">
      <div class="question" id="current-question">
        åœ¨ç¤¾äº¤åœºåˆä¸­ï¼Œä½ é€šå¸¸ä¼š...
      </div>

      <div class="answers">
        <div class="answer-option" onclick="selectAnswer(0)">
          ä¸»åŠ¨ä¸ä»–äººäº¤è°ˆï¼Œæ‰©å±•è‡ªå·±çš„ç¤¾äº¤åœˆ
        </div>
        <div class="answer-option" onclick="selectAnswer(1)">
          ä¸å°‘æ•°å‡ ä¸ªç†Ÿäººäº¤æµï¼Œä¿æŒä¸€å®šçš„ç¤¾äº¤è·ç¦»
        </div>
      </div>
    </div>
  </div>


</div>


  <!-- ç»“æœé¡µé¢ -->
  <div class="container" id="results-page" style="display: none;">
    <header>
      <h1>æµ‹è¯•ç»“æœ</h1>
      <p class="subtitle">æ¢ç´¢ä½ çš„æ€§æ ¼ç‰¹ç‚¹</p>
    </header>
    <!-- å•äººæµ‹è¯•ç»“æœ -->
    <div id="single-results" style="display: none;">
      <div class="card">
        <div class="result-header">
          <div class="result-type" id="single-result-type">ENFP</div>
          <div class="result-name">æ´»åŠ›å‹äººæ ¼</div>
        </div>
        <div class="result-description" id="single-result-description">
          çƒ­æƒ…æ´‹æº¢ã€å¯Œæœ‰åˆ›é€ åŠ›ã€å¥½å¥‡å¿ƒå¼ºï¼Œå–œæ¬¢æ¢ç´¢å„ç§å¯èƒ½æ€§ã€‚ä½ å……æ»¡æ´»åŠ›å’Œçƒ­æƒ…ï¼Œæ“…é•¿ä¸äººäº¤å¾€ï¼Œæ´å¯ŸåŠ›æ•é”ã€‚ä½ çš„åˆ›æ–°æ€ç»´å’Œé€‚åº”æ€§ä½¿ä½ èƒ½åœ¨å„ç§ç¯å¢ƒä¸­èŒå£®æˆé•¿ã€‚
        </div>
        <div style="margin-top: 20px;">
          <h3>æ€§æ ¼ç‰¹ç‚¹</h3>
          <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.5;">
            <li>çƒ­æƒ…å¤–å‘ï¼Œå–„äºä¸äººäº¤å¾€</li>
            <li>å¯Œæœ‰åˆ›é€ åŠ›å’Œæƒ³è±¡åŠ›</li>
            <li>çµæ´»é€‚åº”ï¼Œå–„äºåº”å¯¹å˜åŒ–</li>
            <li>å…³æ³¨å¯èƒ½æ€§è€Œéç°å®</li>
            <li>ç›´è§‰å¼ºï¼Œæ„Ÿå—åŠ›ä¸°å¯Œ</li>
          </ul>
        </div>
        <div style="text-align: center; margin-top: 30px;">
          <button class="btn" onclick="saveTestResult()">ä¿å­˜ç»“æœ</button>
          <button class="btn btn-outline" onclick="showHomePage()">è¿”å›é¦–é¡µ</button>
        </div>
      </div>
    </div>
    <!-- åŒäººæµ‹è¯•ç»“æœ -->
    <div id="dual-results" style="display: none;">
      <div class="card">
        <h2 style="margin-bottom: 20px;">ä½ ä»¬çš„ç»“æœå·²å‡†å¤‡å¥½</h2>
        <p>åœ¨å…¬å¸ƒç»“æœå‰ï¼Œä½ ä»¬å¯ä»¥å°è¯•çŒœæµ‹å¯¹æ–¹çš„MBTIç±»å‹ï¼</p>
        <div style="display: flex; justify-content: space-around; margin: 30px 0; flex-wrap: wrap; gap: 10px;">
          <button class="btn" onclick="showGuessMBTIModal('player2')">çŒœæµ‹å¯¹æ–¹ç±»å‹</button>
          <button class="btn btn-outline" onclick="revealResults()">ç›´æ¥æŸ¥çœ‹ç»“æœ</button>
        </div>
      </div>
      <div id="dual-results-revealed" style="display: none;">
        <div class="result-card">
          <h3 id="player1-name-result">ç©å®¶1</h3>
          <div class="result-header">
            <div class="result-type" id="player1-result-type">INTJ</div>
            <div class="result-name">å»ºç­‘å¸ˆå‹äººæ ¼</div>
          </div>
          <div class="result-description" id="player1-result-description">
            å…·æœ‰æˆ˜ç•¥æ€ç»´çš„åˆ›æ–°è€…ï¼Œå¼ºè°ƒçŸ¥è¯†å’Œèƒ½åŠ›ï¼Œè¿½æ±‚æŒç»­æ”¹è¿›å’Œæ•ˆç‡ã€‚ä½ ç‹¬ç«‹ã€æœæ–­ã€æœ‰æ¡ç†ï¼Œå–„äºåˆ¶å®šé•¿æœŸè®¡åˆ’å’Œè§£å†³å¤æ‚é—®é¢˜ã€‚
          </div>
        </div>
        <div class="result-card">
          <h3 id="player2-name-result">ç©å®¶2</h3>
          <div class="result-header">
            <div class="result-type" id="player2-result-type">ESFP</div>
            <div class="result-name">è¡¨æ¼”è€…å‹äººæ ¼</div>
          </div>
          <div class="result-description" id="player2-result-description">
            çƒ­çˆ±ç”Ÿæ´»çš„è¡¨æ¼”è€…ï¼Œè‡ªå‘ã€å……æ»¡æ´»åŠ›ã€ä¹äºå¨±ä¹ä»–äººã€‚ä½ å¤–å‘ã€å¯Œæœ‰åŒæƒ…å¿ƒï¼Œå–œæ¬¢ä¸äººäº’åŠ¨ï¼Œäº«å—å½“ä¸‹ï¼Œé€‚åº”æ€§å¼ºï¼Œä¸æ‹˜æ³¥äºè§„åˆ™ã€‚
          </div>
        </div>
        <div class="compatibility">
          <div class="compatibility-title">ä½ ä»¬çš„å…³ç³»ç›¸å¤„æŒ‡å—</div>
          <div id="compatibility-description">
            <p><strong>ä¼˜åŠ¿äº’è¡¥:</strong> INTJçš„æˆ˜ç•¥æ€ç»´å’ŒESFPçš„ç°å®æ„ŸçŸ¥èƒ½å½¢æˆè‰¯å¥½äº’è¡¥ï¼Œä¸€ä¸ªå…³æ³¨æœªæ¥å’Œå¯èƒ½æ€§ï¼Œä¸€ä¸ªå…³æ³¨å½“ä¸‹å’Œå®é™…ä½“éªŒã€‚</p>
            <p><strong>æ½œåœ¨æŒ‘æˆ˜:</strong> INTJå¯èƒ½è§‰å¾—ESFPè¿‡äºå†²åŠ¨å’Œç¼ºä¹è§„åˆ’ï¼Œè€ŒESFPå¯èƒ½è®¤ä¸ºINTJè¿‡äºä¸¥è‚ƒå’Œç¼ºä¹æƒ…æ„Ÿè¡¨è¾¾ã€‚</p>
            <p><strong>ç›¸å¤„å»ºè®®:</strong></p>
            <ul style="margin-left: 20px; margin-top: 10px;">
              <li>INTJéœ€è¦ç†è§£ESFPäº«å—å½“ä¸‹çš„å¤©æ€§ï¼Œç»™äºˆå…¶è‡ªç”±å’Œè¡¨è¾¾çš„ç©ºé—´</li>
              <li>ESFPåº”å°Šé‡INTJéœ€è¦ç‹¬å¤„æ€è€ƒçš„éœ€æ±‚ï¼Œä¸è¦å°†å…¶è§†ä¸ºå†·æ¼ </li>
              <li>å»ºç«‹å¼€æ”¾çš„æ²Ÿé€šæ–¹å¼ï¼Œåˆ†äº«å„è‡ªçš„æƒ³æ³•å’Œéœ€æ±‚</li>
              <li>å…±åŒè®¾å®šç›®æ ‡å’Œè®¡åˆ’ï¼Œäº’ç›¸å­¦ä¹ å¯¹æ–¹çš„é•¿å¤„</li>
            </ul>
          </div>
        </div>
        <div style="text-align: center; margin-top: 30px;">
          <button class="btn" onclick="saveTestResult()">ä¿å­˜ç»“æœ</button>
          <button class="btn btn-outline" onclick="showHomePage()">è¿”å›é¦–é¡µ</button>
        </div>
      </div>
    </div>
  </div>
  <!-- æˆ‘çš„é¡µé¢ -->
  <div class="container" id="profile-page" style="display: none;">
    <header>
      <h1>æˆ‘çš„MBTI</h1>
      <p class="subtitle">æŸ¥çœ‹ä½ çš„æµ‹è¯•å†å²å’Œç»“æœ</p>
    </header>
    <div class="profile-header">
      <div class="profile-avatar">
        <img src="https://via.placeholder.com/80" alt="ç”¨æˆ·å¤´åƒ" id="user-avatar">
      </div>
      <div class="profile-info">
        <div class="profile-name" id="profile-name">å¾®ä¿¡ç”¨æˆ·</div>
        <div class="profile-mbti">
          <span>æœ€è¿‘æµ‹è¯•ç»“æœ:</span>
          <span class="profile-mbti-type" id="latest-mbti">ENFP</span>
        </div>
      </div>
    </div>
    <div class="card">
      <h2>æµ‹è¯•å†å²</h2>
      <div id="test-history-list">
        <!-- å†å²æµ‹è¯•è®°å½• -->
        <div class="history-item" onclick="showHistoryDetail('202305101')">
          <div class="history-date">
            <div class="history-date-day">15</div>
            <div>6æœˆ</div>
          </div>
          <div class="history-content">
            <div class="history-title">æ ‡å‡†ç‰ˆæµ‹è¯•</div>
            <div class="history-type">
              <span class="history-mbti">ENFP</span>
              <span class="history-with">å•äººæµ‹è¯•</span>
            </div>
          </div>
          <div class="history-arrow">â€º</div>
        </div>
        <div class="history-item" onclick="showHistoryDetail('202305102')">
          <div class="history-date">
            <div class="history-date-day">10</div>
            <div>6æœˆ</div>
          </div>
          <div class="history-content">
            <div class="history-title">åŒäººæµ‹è¯•</div>
            <div class="history-type">
              <span class="history-mbti">INTJ</span>
              <span class="history-with">ä¸ å¥½å‹A</span>
            </div>
          </div>
          <div class="history-arrow">â€º</div>
        </div>
        <div class="history-item" onclick="showHistoryDetail('202305103')">
          <div class="history-date">
            <div class="history-date-day">05</div>
            <div>6æœˆ</div>
          </div>
          <div class="history-content">
            <div class="history-title">ç®€çŸ­ç‰ˆæµ‹è¯•</div>
            <div class="history-type">
              <span class="history-mbti">ENFJ</span>
              <span class="history-with">å•äººæµ‹è¯•</span>
            </div>
          </div>
          <div class="history-arrow">â€º</div>
        </div>
        <div class="history-item" onclick="showHistoryDetail('202305104')">
          <div class="history-date">
            <div class="history-date-day">28</div>
            <div>5æœˆ</div>
          </div>
          <div class="history-content">
            <div class="history-title">åŒäººæµ‹è¯•</div>
            <div class="history-type">
              <span class="history-mbti">ENFP</span>
              <span class="history-with">ä¸ å¥½å‹B</span>
            </div>
          </div>
          <div class="history-arrow">â€º</div>
        </div>
      </div>
    </div>
  </div>
  <!-- å†å²è®°å½•è¯¦æƒ…å¼¹çª— -->
  <div class="modal" id="history-detail-modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">æµ‹è¯•ç»“æœè¯¦æƒ…</div>
        <button class="close-btn" onclick="closeModal('history-detail-modal')">&times;</button>
      </div>
      <div id="history-detail-content">
        <!-- åŠ¨æ€åŠ è½½å†å²è®°å½•è¯¦æƒ… -->
      </div>
    </div>
  </div>
  <!-- çŒœæµ‹MBTIç±»å‹å¼¹çª— -->
  <div class="modal" id="guess-mbti-modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">çŒœæµ‹<span id="guessing-player-name">ç©å®¶2</span>çš„MBTIç±»å‹</div>
        <button class="close-btn" onclick="closeModal('guess-mbti-modal')">&times;</button>
      </div>
      <div class="mbti-selector">
        <div class="letter-selector">
          <div class="selector-arrows">
            <div class="arrow" onclick="scrollLetter(0, 'up')">â–²</div>
          </div>
          <div class="letter-display" id="letter-1">E</div>
          <div class="selector-arrows">
            <div class="arrow" onclick="scrollLetter(0, 'down')">â–¼</div>
          </div>
          <div class="letter-hint">
            <strong>E: å¤–å‘å‹</strong><br>
            ä»å¤–éƒ¨ä¸–ç•Œè·å–èƒ½é‡
          </div>
        </div>
        <div class="letter-selector">
          <div class="selector-arrows">
            <div class="arrow" onclick="scrollLetter(1, 'up')">â–²</div>
          </div>
          <div class="letter-display" id="letter-2">N</div>
          <div class="selector-arrows">
            <div class="arrow" onclick="scrollLetter(1, 'down')">â–¼</div>
          </div>
          <div class="letter-hint">
            <strong>N: ç›´è§‰å‹</strong><br>
            å…³æ³¨æ¦‚å¿µå’Œå¯èƒ½æ€§
          </div>
        </div>
        <div class="letter-selector">
          <div class="selector-arrows">
            <div class="arrow" onclick="scrollLetter(2, 'up')">â–²</div>
          </div>
          <div class="letter-display" id="letter-3">F</div>
          <div class="selector-arrows">
            <div class="arrow" onclick="scrollLetter(2, 'down')">â–¼</div>
          </div>
          <div class="letter-hint">
            <strong>F: æƒ…æ„Ÿå‹</strong><br>
            åŸºäºä»·å€¼è§‚å’Œæ„Ÿå—å†³ç­–
          </div>
        </div>
        <div class="letter-selector">
          <div class="selector-arrows">
            <div class="arrow" onclick="scrollLetter(3, 'up')">â–²</div>
          </div>
          <div class="letter-display" id="letter-4">P</div>
          <div class="selector-arrows">
            <div class="arrow" onclick="scrollLetter(3, 'down')">â–¼</div>
          </div>
          <div class="letter-hint">
            <strong>P: æ„ŸçŸ¥å‹</strong><br>
            çµæ´»ã€é€‚åº”æ€§å¼ºï¼Œä¿æŒå¼€æ”¾
          </div>
        </div>
      </div>
      <div style="margin-top: 20px; text-align: center;">
        <button class="btn" onclick="submitGuess()">æäº¤çŒœæµ‹</button>
        <button class="btn btn-outline" onclick="skipGuessing()">è·³è¿‡çŒœæµ‹</button>
      </div>
    </div>
  </div>
  <script>
    // å¾®ä¿¡æˆæƒç›¸å…³
    function initWechatAuth() {
// æ¨¡æ‹Ÿå¾®ä¿¡æˆæƒæˆåŠŸåçš„å›è°ƒ
      setTimeout(() => {
// æ›´æ–°ç”¨æˆ·ä¿¡æ¯
        document.getElementById('wx-nickname').textContent = 'å¼ å°æ˜';
        document.getElementById('profile-name').textContent = 'å¼ å°æ˜';
        document.getElementById('user-avatar').src = 'https://via.placeholder.com/80/3498db/ffffff?text=å¼ ';
      }, 1000);
    }
    // é¡µé¢åˆå§‹åŒ–
    window.onload = function() {
      initWechatAuth();
    };
    // æ˜¾ç¤ºä¸»é¡µ
    function showHomePage() {
      document.getElementById('home-page').style.display = 'block';
      document.getElementById('single-test-options-page').style.display = 'none';
      document.getElementById('dual-test-options-page').style.display = 'none';
      document.getElementById('create-room-page').style.display = 'none';
      document.getElementById('room-info-page').style.display = 'none';
      document.getElementById('join-room-page').style.display = 'none';
      document.getElementById('test-page').style.display = 'none';
      document.getElementById('results-page').style.display = 'none';
      document.getElementById('profile-page').style.display = 'none';
// æ›´æ–°åº•éƒ¨å¯¼èˆªçŠ¶æ€
      updateNavState('home');
    }
    // æ˜¾ç¤ºæµ‹è¯•å†å²é¡µé¢
    function showTestHistory() {
      document.getElementById('home-page').style.display = 'none';
      document.getElementById('single-test-options-page').style.display = 'none';
      document.getElementById('dual-test-options-page').style.display = 'none';
      document.getElementById('create-room-page').style.display = 'none';
      document.getElementById('room-info-page').style.display = 'none';
      document.getElementById('join-room-page').style.display = 'none';
      document.getElementById('test-page').style.display = 'none';
      document.getElementById('results-page').style.display = 'none';
      document.getElementById('profile-page').style.display = 'block';
// æ›´æ–°åº•éƒ¨å¯¼èˆªçŠ¶æ€
      updateNavState('profile');
    }
    // æ›´æ–°åº•éƒ¨å¯¼èˆªçŠ¶æ€
    function updateNavState(active) {
      const navItems = document.querySelectorAll('.nav-item');
      navItems.forEach(item => {
        item.classList.remove('active');
      });
      if (active === 'home') {
        navItems[0].classList.add('active');
      } else if (active === 'profile') {
        navItems[1].classList.add('active');
      }
    }
    // æ˜¾ç¤ºå•äººæµ‹è¯•é€‰é¡¹
    function showSingleTestOptions() {
      document.getElementById('home-page').style.display = 'none';
      document.getElementById('single-test-options-page').style.display = 'block';
    }
    // æ˜¾ç¤ºåŒäººæµ‹è¯•é€‰é¡¹
    function showDualTestOptions() {
      document.getElementById('home-page').style.display = 'none';
      document.getElementById('dual-test-options-page').style.display = 'block';
      document.getElementById('create-room-page').style.display = 'none';
      document.getElementById('join-room-page').style.display = 'none';
    }
    // å¼€å§‹å•äººæµ‹è¯•
    function startSingleTest(version) {
      document.getElementById('single-test-options-page').style.display = 'none';
      document.getElementById('test-page').style.display = 'block';
      document.getElementById('dual-test-info').style.display = 'none';
      let versionText = 'æ ‡å‡†ç‰ˆ';
      let questionCount = 60;
      if (version === 'short') {
        versionText = 'ç®€çŸ­ç‰ˆ';
        questionCount = 20;
      } else if (version === 'full') {
        versionText = 'å®Œæ•´ç‰ˆ';
        questionCount = 93;
      }
      document.getElementById('test-version-title').textContent = ${versionText}æµ‹è¯• (${questionCount}é¢˜);
      document.getElementById('test-progress').style.width = '5%';
// è¿™é‡Œå¯ä»¥åŠ è½½æµ‹è¯•é¢˜ç›®
    }
    // åˆ›å»ºæˆ¿é—´é¡µé¢
    function createRoom() {
      document.getElementById('dual-test-options-page').style.display = 'none';
      document.getElementById('create-room-page').style.display = 'block';
    }
    // åŠ å…¥æˆ¿é—´é¡µé¢
    function showJoinRoomPage() {
      document.getElementById('dual-test-options-page').style.display = 'none';
      document.getElementById('join-room-page').style.display = 'block';
    }
    // ç”Ÿæˆæˆ¿é—´
    function generateRoom() {
      document.getElementById('create-room-page').style.display = 'none';
      document.getElementById('room-info-page').style.display = 'block';
      document.getElementById('player1-name').textContent = document.getElementById('wx-nickname').textContent;
// ç”Ÿæˆéšæœºæˆ¿é—´å·
      const roomId = Math.floor(100000 + Math.random() * 900000);
      document.getElementById('room-id').textContent = roomId;
// æ¨¡æ‹Ÿç©å®¶2åŠ å…¥
      setTimeout(() => {
        document.getElementById('player2-name').textContent = 'ç©å®¶2';
        document.getElementById('start-test-btn').disabled = false;
// æ·»åŠ å¼€å§‹æµ‹è¯•äº‹ä»¶ç›‘å¬
        document.getElementById('start-test-btn').onclick = function() {
          startDualTest();
        };
      }, 3000);
    }
    // åŠ å…¥æˆ¿é—´
    function joinRoom() {
      const roomCode = document.getElementById('room-code').value;
      if (!roomCode) {
        alert('è¯·è¾“å…¥æˆ¿é—´å·');
        return;
      }
// è¿™é‡Œåº”è¯¥æ˜¯éªŒè¯æˆ¿é—´å·å¹¶åŠ å…¥æˆ¿é—´çš„é€»è¾‘
// æ¼”ç¤ºç›´æ¥è·³è½¬åˆ°æµ‹è¯•é¡µé¢
      startDualTest();
    }
    // å¼€å§‹åŒäººæµ‹è¯•
    function startDualTest() {
      document.getElementById('room-info-page').style.display = 'none';
      document.getElementById('join-room-page').style.display = 'none';
      document.getElementById('test-page').style.display = 'block';
      document.getElementById('dual-test-info').style.display = 'block';
// è®¾ç½®æµ‹è¯•ä¿¡æ¯
      document.getElementById('test-version-title').textContent = 'åŒäººæµ‹è¯• (60é¢˜)';
      document.getElementById('test-progress').style.width = '5%';
// è¿™é‡Œå¯ä»¥åŠ è½½æµ‹è¯•é¢˜ç›®
    }
    // é€‰æ‹©ç­”æ¡ˆ
    function selectAnswer(index) {
// æ›´æ–°è¿›åº¦æ¡
      const currentWidth = parseInt(document.getElementById('test-progress').style.width);
      const newWidth = Math.min(currentWidth + 5, 100);
      document.getElementById('test-progress').style.width = newWidth + '%';
// å¦‚æœæµ‹è¯•å®Œæˆï¼Œæ˜¾ç¤ºç»“æœé¡µé¢
      if (newWidth >= 100) {
        showResults();
      } else {
// è¿™é‡Œå¯ä»¥åŠ è½½ä¸‹ä¸€é¢˜
      }
    }
    // é€‰æ‹©æµ‹è¯•ç‰ˆæœ¬
    function selectTestVersion(version) {
// å¯ä»¥åœ¨è¿™é‡Œè®¾ç½®é€‰ä¸­çš„æ ·å¼
      const buttons = document.querySelectorAll('#create-room-page .btn-outline');
      buttons.forEach(btn => {
        btn.style.background = 'transparent';
        btn.style.color = 'var(--primary-color)';
      });
      event.target.style.background = 'var(--primary-color)';
      event.target.style.color = 'white';
    }
    // å¤åˆ¶æˆ¿é—´å·
    function copyRoomId() {
      const roomId = document.getElementById('room-id').textContent;
      navigator.clipboard.writeText(roomId).then(() => {
        alert('æˆ¿é—´å·å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
      });
    }
    // åˆ†äº«é“¾æ¥
    function shareLink() {
      const roomId = document.getElementById('room-id').textContent;
      const shareUrl = ${window.location.origin}${window.location.pathname}?room=${roomId};
      if (navigator.share) {
        navigator.share({
          title: 'MBTIåŒäººæµ‹è¯•',
          text: 'æ¥å’Œæˆ‘ä¸€èµ·åšMBTIæµ‹è¯•å§ï¼',
          url: shareUrl
        });
      } else {
        navigator.clipboard.writeText(shareUrl).then(() => {
          alert('é‚€è¯·é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
        });
      }
    }
    // ä¸‹è½½äºŒç»´ç 
    function downloadQRCode() {
// å®é™…åº”ç”¨ä¸­éœ€è¦å®ç°äºŒç»´ç ä¸‹è½½é€»è¾‘
      alert('äºŒç»´ç å·²ä¿å­˜');
    }
    // é€€å‡ºæˆ¿é—´
    function exitRoom() {
      document.getElementById('room-info-page').style.display = 'none';
      document.getElementById('dual-test-options-page').style.display = 'block';
    }
    // æ˜¾ç¤ºç»“æœ
    function showResults() {
      document.getElementById('test-page').style.display = 'none';
      document.getElementById('results-page').style.display = 'block';
// æ ¹æ®æµ‹è¯•æ¨¡å¼æ˜¾ç¤ºä¸åŒçš„ç»“æœ
      if (document.getElementById('dual-test-info').style.display === 'block') {
        document.getElementById('single-results').style.display = 'none';
        document.getElementById('dual-results').style.display = 'block';
      } else {
        document.getElementById('single-results').style.display = 'block';
        document.getElementById('dual-results').style.display = 'none';
      }
    }
    // æ˜¾ç¤ºçŒœæµ‹MBTIç±»å‹å¼¹çª—
    function showGuessMBTIModal(playerName) {
      document.getElementById('guess-mbti-modal').style.display = 'flex';
      document.getElementById('guessing-player-name').textContent = playerName;
    }
    // å…³é—­å¼¹çª—
    function closeModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
    }
    // å±•ç¤ºç»“æœ
    function revealResults() {
      document.getElementById('dual-results-revealed').style.display = 'block';
    }
    // ä¿å­˜æµ‹è¯•ç»“æœ
    function saveTestResult() {
      alert('æµ‹è¯•ç»“æœå·²ä¿å­˜åˆ°æ‚¨çš„å†å²è®°å½•ä¸­');
      showHomePage();
    }
    // æ»‘åŠ¨é€‰æ‹©å­—æ¯
    function scrollLetter(index, direction) {
      const letters = [
        ['E', 'I'],
        ['N', 'S'],
        ['F', 'T'],
        ['P', 'J']
      ];
      const currentLetter = document.getElementById(letter-${index+1}).textContent;
      const currentIndex = letters[index].indexOf(currentLetter);
      let newIndex;
      if (direction === 'up') {
        newIndex = (currentIndex - 1 + letters[index].length) % letters[index].length;
      } else {
        newIndex = (currentIndex + 1) % letters[index].length;
      }
      document.getElementById(letter-${index+1}).textContent = letters[index][newIndex];
      updateLetterHint(index, letters[index][newIndex]);
    }
    // æ›´æ–°å­—æ¯æç¤º
    function updateLetterHint(index, letter) {
      const hints = {
        'E': '<strong>E: å¤–å‘å‹</strong><br>ä»å¤–éƒ¨ä¸–ç•Œè·å–èƒ½é‡',
        'I': '<strong>I: å†…å‘å‹</strong><br>ä»å†…å¿ƒä¸–ç•Œè·å–èƒ½é‡',
        'N': '<strong>N: ç›´è§‰å‹</strong><br>å…³æ³¨æ¦‚å¿µå’Œå¯èƒ½æ€§',
        'S': '<strong>S: æ„Ÿè§‰å‹</strong><br>å…³æ³¨ç°å®å’Œç»†èŠ‚',
        'F': '<strong>F: æƒ…æ„Ÿå‹</strong><br>åŸºäºä»·å€¼è§‚å’Œæ„Ÿå—å†³ç­–',
        'T': '<strong>T: æ€è€ƒå‹</strong><br>åŸºäºé€»è¾‘å’Œå®¢è§‚åˆ†æå†³ç­–',
        'P': '<strong>P: æ„ŸçŸ¥å‹</strong><br>çµæ´»ã€é€‚åº”æ€§å¼ºï¼Œä¿æŒå¼€æ”¾',
        'J': '<strong>J: åˆ¤æ–­å‹</strong><br>æœ‰è®¡åˆ’ã€æœ‰æ¡ç†ï¼Œå–œæ¬¢ç¡®å®šæ€§'
      };
      const letterSelector = document.querySelectorAll('.letter-selector')[index];
      letterSelector.querySelector('.letter-hint').innerHTML = hints[letter];
    }
    // æäº¤çŒœæµ‹
    function submitGuess() {
      const mbti =
        document.getElementById('letter-1').textContent +
        document.getElementById('letter-2').textContent +
        document.getElementById('letter-3').textContent +
        document.getElementById('letter-4').textContent;
      alert(ä½ çŒœæµ‹çš„MBTIç±»å‹æ˜¯: ${mbti});
      closeModal('guess-mbti-modal');
      revealResults();
    }
    // è·³è¿‡çŒœæµ‹
    function skipGuessing() {
      closeModal('guess-mbti-modal');
      revealResults();
    }
    // æ˜¾ç¤ºå†å²è®°å½•è¯¦æƒ…
    function showHistoryDetail(historyId) {
      document.getElementById('history-detail-modal').style.display = 'flex';
// æ ¹æ®å†å²IDåŠ è½½è¯¦æƒ…
      const detailContent = document.getElementById('history-detail-content');
// è¿™é‡Œåº”è¯¥æ˜¯é€šè¿‡APIè·å–å†å²è®°å½•è¯¦æƒ…
// æ¼”ç¤ºç›´æ¥è®¾ç½®å†…å®¹
      detailContent.innerHTML = <div class="result-header"> <div class="result-type">ENFP</div> <div class="result-name">æ´»åŠ›å‹äººæ ¼</div> </div> <div style="margin: 15px 0; color: #666;"> <p>æµ‹è¯•æ—¥æœŸ: 2023-06-15</p> <p>æµ‹è¯•ç‰ˆæœ¬: æ ‡å‡†ç‰ˆ (60é¢˜)</p> </div> <div class="result-description"> çƒ­æƒ…æ´‹æº¢ã€å¯Œæœ‰åˆ›é€ åŠ›ã€å¥½å¥‡å¿ƒå¼ºï¼Œå–œæ¬¢æ¢ç´¢å„ç§å¯èƒ½æ€§ã€‚ä½ å……æ»¡æ´»åŠ›å’Œçƒ­æƒ…ï¼Œæ“…é•¿ä¸äººäº¤å¾€ï¼Œæ´å¯ŸåŠ›æ•é”ã€‚ä½ çš„åˆ›æ–°æ€ç»´å’Œé€‚åº”æ€§ä½¿ä½ èƒ½åœ¨å„ç§ç¯å¢ƒä¸­èŒå£®æˆé•¿ã€‚ </div> <div style="margin-top: 20px;"> <h3>æ€§æ ¼ç‰¹ç‚¹</h3> <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.5;"> <li>çƒ­æƒ…å¤–å‘ï¼Œå–„äºä¸äººäº¤å¾€</li> <li>å¯Œæœ‰åˆ›é€ åŠ›å’Œæƒ³è±¡åŠ›</li> <li>çµæ´»é€‚åº”ï¼Œå–„äºåº”å¯¹å˜åŒ–</li> <li>å…³æ³¨å¯èƒ½æ€§è€Œéç°å®</li> <li>ç›´è§‰å¼ºï¼Œæ„Ÿå—åŠ›ä¸°å¯Œ</li> </ul> </div> ;
    }
  </script>
</body>
</html>
